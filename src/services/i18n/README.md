# Интернационализация (i18n)

## `imports.ts`

Импорт словарей из разных `feauters`. Новый словарь необходимо сначала прописать в локаль `*`, так 
как по ней определятся доступные ключи для перевода. В локаль `*` обычно прописываются переводы
на английском языке. Поэтому повторять импорт словаря в английскую локаль нет необходимости. 
Если нет перевода в текущей локали, то будет использоваться перевод из локали `*`.

Приложению доступны только те локали, что прописаны в файле `imports.ts`. Локаль может быть указана
в короткой форме без региона, например `ru` вместо `ru-RU`.

```js
export default {
  '*': {
    
  },
  'en-EN': {
    
  },
  'ru': {

  }
}
```

Словарь прописывается по ключи, по которому будут доступны переводы из него. Для динамической 
загрузки словаря указывается функция, возвращающая результат динамического импорта.

```js
export default {
  '*': {
    'example': () => import('@src/features/example/translations/en.json'),
  }
}
```

Словарь можно прописать явно объектом или импортировать синхронно и прописать результат импота. Такие
словарь будут сразу доступны без ожидания загрузки.

```js
import authEn from '@src/features/example/translations/en.json';

export default {
  '*': {
    'example': authEn,
  }
}
```

## `use-i18n.ts`

Хук для получения кода текущей локали `locale`, списка доступных локалей `locales`, функции смены 
локали `setLocale()`, функции перевода `t()` и функции форматирования числа с учётом локали `n()`.
Если меняется локаль или словарь, то хук вернёт новую функцию перевода. 
При этом компонент перерендерится.

```ts
const {locale, locales, setLocale, t, n} = useI18n();

const title = t(`example.title`);
```

Для перевода с учётом множественного числа в опции plural указывается число для склонения. В словаре 
должны быть переводы под соответствующие множественные формы
```ts
const countText = t(`example.basket.articles`, {plural: 5}); // 5 товаров
```
Словарь с учётом плюрализации. В русском языке 3 формы и `other` используется для дробных чисел. 
Под другие языки доступны: `zero`, `one`, `two`, `few`, `many`, `other`. 
В английском 2 формы: `one` и `other`
```json
{
  "basket": {
    "articles": {
      "one": "товар",
      "few": "товара",
      "many": "товаров",
      "other": "товара"
    }
  }
}
```

Числовое значение можно подставить в перевод в область `{{plural}}`
```json
{
  "count": {
    "one": "Остался {{plural}} рубль!!!",
    "few": "Осталось {{plural}} рубля!!",
    "many": "Осталось {{plural}} рублей!"
  }
}
```
```ts
const countText = t(`example.count`, {plural: 100}); // Осталось 100 рублей!
```

При первом обращении к функции перевода динамически подгружается словарь. Если словарь ещё в процессе
загрузки, то вернётся перевод по умолчанию `fall` (если передан) или код переводимой фразы. Если
словарь текущей локали загружен, но в нём нет перевода, то вернётся перевод из базовой локали.

```ts
const text = t(`example.title`, {fall: 'Title'});
```

Поддерживается шаблон перевода с областями для вставки значений. Именованные обалсти для вставки 
значений указываются в строке перевода.
```json
{
  "welcome": "Привет {{name}} {{secondName}}!!!"
}
```
```ts
const text = t(`example.welcome`, {values: {name: 'Василий', secondName: 'Пупкин'}});
```

По умолчанию поддерживается React `<Suspense>`. Ожидание срабатывает при загрузке динамически
подключенных словарей. Для этого функция `t()` выбрасывает исключение с промисом. Если не нужен режим
suspense, то его можно отключить в опциях функции `t()`.

```ts
const text = t(`example.title`, {suspense: false});
```

Можно указать желаемую локаль для перевода. Локаль должна быть определена в файле импорта словарей.

```ts
const text = t(`example.title`, {locale: 'ru-RU'});
```
## `service.ts`

## `types.ts`

Типы выводятся автоматически на основе базовой локали `*`. Новые словари сперва необходимо подключать 
в базовую локаль. После подключаются переводы под конкретные локали. 
За счёт типизации словарей будут поссказки в коде на доступные ключи переводов. 

Добавлять новые типы или корректировать существующие не требуется.  
